---
name: Modules.BLE
extends: Titanium.Module
summary: Add-on Bluetooth Low Energy module
description: |
    Using Bluetooth Low Energy module is used to interact with Bluetooth Low Energy (BLE) devices.
    Note (IOS): Starting iOS 13, it's mandatory for developers to specify the Privacy Usage Description for Bluetooth by including NSBluetoothAlwaysUsageDescription in their info.plist file. 
    Otherwise accessing any Core Bluetooth APIs would lead to a crash. For backward support for older iOS versions, NSBluetoothPeripheralUsageDescription needs to be defined.
platforms: [android, iphone, ipad] 

properties:
  - name: AUTHORISATION_STATUS_NOT_DETERMINED
    type: Number
    summary: A state that indicates the user has yet to authorize Bluetooth for this app.
    permission: read-only
    value: 0

  - name: AUTHORISATION_STATUS_RESTRICTED
    type: Number
    summary: A state that indicates this app isn’t authorized to use Bluetooth.
    permission: read-only
    value: 1
    
  - name: AUTHORISATION_STATUS_DENIED
    type: Number
    summary: A state that indicates the user explicitly denied Bluetooth access for this app.
    permission: read-only
    value: 2
    
  - name: AUTHORISATION_STATUS_ALLOWED_ALWAYS
    type: Number
    summary: A state that indicates the user has authorized Bluetooth at any time.
    permission: read-only
    value: 3

  - name: ATTRIBUTE_PERMISSION_READABLE
    type: Number
    summary: A permission that indicates a peripheral can read the attribute’s value.
    permission: read-only
    value: 0
    
  - name: ATTRIBUTE_PERMISSION_WRITEABLE
    type: Number
    summary: A permission that indicates a peripheral can write the attribute’s value.
    permission: read-only
    value: 1

  - name: ATTRIBUTE_PERMISSION_READ_ENCRYPTION_REQUIRED
    type: Number
    summary: A permission that indicates only trusted devices can read the attribute’s value.
    permission: read-only
    value: 2

  - name: ATTRIBUTE_PERMISSION_WRITE_ENCRYPTION_REQUIRED
    type: Number
    summary: A permission that indicates only trusted devices can write the attribute’s value.
    permission: read-only
    value: 3

  - name: CHARACTERISTIC_PROPERTIES_BROADCAST
    type: Number
    summary: A property that indicates the characteristic can broadcast its value using a characteristic configuration descriptor.
    permission: read-only
    value: 0

  - name: CHARACTERISTIC_PROPERTIES_READ
    type: Number
    summary: A property that indicates a peripheral can read the characteristic’s value.
    permission: read-only
    value: 1

  - name: CHARACTERISTIC_PROPERTIES_WRITE_WITHOUT_RESPONSE
    type: Number
    summary: A property that indicates a peripheral can write the characteristic's value, without a response to indicate that the write succeeded.
    permission: read-only
    value: 2

  - name: CHARACTERISTIC_PROPERTIES_WRITE
    type: Number
    summary: A property that indicates a peripheral can write the characteristic’s value, with a response to indicate that the write succeeded.
    permission: read-only
    value: 3

  - name: CHARACTERISTIC_PROPERTIES_NOTIFY
    type: Number
    summary: A property that indicates the peripheral permits notifications of the characteristic’s value, without a response from the central to indicate receipt of the notification.
    permission: read-only
    value: 4

  - name: CHARACTERISTIC_PROPERTIES_INDICATE
    type: Number
    summary: A property that indicates the peripheral permits notifications of the characteristic’s value, with a response from the central to indicate receipt of the notification.
    permission: read-only
    value: 5

  - name: CHARACTERISTIC_PROPERTIES_AUTHENTICATED_SIGNED_WRITES
    type: Number
    summary: A property that indicates the perhipheral allows signed writes of the characteristic’s value, without a response to indicate the write succeeded.
    permission: read-only
    value: 6

  - name: CHARACTERISTIC_PROPERTIES_EXTENDED_PROPERTIES
    type: Number
    summary: A property that indicates the characteristic defines additional properties in the extended properties descriptor.A property that indicates the characteristic defines additional properties in the extended properties descriptor.
    permission: read-only
    value: 7

  - name: CHARACTERISTIC_PROPERTIES_NOTIFY_ENCRYPTION_REQUIRED
    type: Number
    summary: A property that indicates that only trusted devices can enable notifications of the characteristic’s value.
    permission: read-only
    value: 8

  - name: CHARACTERISTIC_PROPERTIES_INDICATE_ENCRYPTION_REQUIRED
    type: Number
    summary: A property that indicates only trusted devices can enable indications of the characteristic’s value.
    permission: read-only
    value: 9

methods:
  - name: addService
    summary: Publishes a service and any of its associated characteristics and characteristic descriptors to the local GATT database.
    parameters:
      - name: data
        type: Object
        summary: The value of the characteristic.
      - name: properties
        type: Number
        summary: The properties of the characteristic. 
      - name: permissions
        type: Number
        summary: The permissions of the characteristic value.
      - name: characteristics
        type: Array<Modules.BLE.Characteristic>
        summary: A list of characteristics of a service.
      - name: uuid
        type: String
        summary: The Bluetooth-specific UUID of the attribute.
      - name: primary
        type: Number
        summary: The properties of the characteristic. 
    returns:
      type: Modules.BLE.Service
      summary: Object of service which is added.

  - name: removeServices
    summary: Removes a specified published service from the local GATT database.
    parameters:
      - name: service
        type: Modules.BLE.Service
        summary: Object of service you want to remove.
    returns:
      type: void

  - name: removeAllServices
    summary: Removes all published services from the local GATT database.
    returns:
      type: void
